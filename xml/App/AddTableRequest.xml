<talnet type="request">
	<request type="APP" name="ADD_TABLE">
		<description>
			This request creates a new dynamic table.
		</description>
		<requestArguments>
			<requestArgument type="String" name="appName" key="appName">The name of the application using the modified table</requestArgument>
			<requestArgument type="String" name="tableName" key="tableName">The modified table name</requestArgument>
			<requestArgumentList name="columns" key="cols">
				<requestArgument type="String" name="colName" key="colName">The modified table name</requestArgument>
				<requestArgument type="Integer" name="size" key="size">The modified table name</requestArgument>
				<requestArgument type="ColType" name="type" key="colType">The modified table name</requestArgument>
				<requestArgument type="Boolean" name="autoInc" key="autoInc">The modified table name</requestArgument>
				<requestArgument type="Boolean" name="isPrimary" key="isPrimary">The modified table name</requestArgument>
			</requestArgumentList>
		</requestArguments>
		<validation>
			<credentials type="AppAdmin" errorid="6">
				<argument id="1">{appName}</argument>
			</credentials>
			<existence gate="not" type="TableByName" errorid="12">
				<argument id="1">{appName}_{tableName}</argument>
			</existence>
			<foreach argname="columns" errorid="15">
				<string target="{colName}" type="isAlphaNumeric" errorid="15"></string>
			</foreach>
			<atleast argname="columns" errorid="21">
				<string target="{isPrimary}" type="equals" errorid="17">
					<argument id="1">true</argument>
				</string>
			</atleast>
			<string target="{appName}" type="matches" errorid="15">
				<argument id="1">[a-zA-Z][\\w]*</argument>
			</string>
		</validation>
		<performance>
			<dynamicSqlExecute query="CreateTable">
				<argument id="1">{appName}_{tableName}</argument>
				<argument id="2">{columns}</argument>
			</dynamicSqlExecute>
			<sqlExecute query="AddTable">
				<argument id="1">{appName}_{tableName}</argument>
				<argument id="2">{appName}</argument>
			</sqlExecute>
			<foreach argname="enum:PermissionType(per)">
				<sqlExecute query="AddPermissionGroupForTable">
					<argument id="1">{appName}</argument>
					<argument id="2">{appName}_{tableName}</argument>
					<argument id="3">{per}</argument>
					<argument id="4">{appName}_admin</argument>
				</sqlExecute>
			</foreach>	
		</performance>
	</request>
</talnet>